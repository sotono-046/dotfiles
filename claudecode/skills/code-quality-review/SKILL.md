---
name: code-quality-review
description: コードベースの品質・セキュリティ・パフォーマンスを包括的に検証し、改善計画を策定するスキル。コードレビュー、セキュリティチェック、バグ検出、パフォーマンス最適化が必要な場合に自動的にトリガーされる。対象：(1) コード変更のレビュー依頼、(2) セキュリティ脆弱性の検出、(3) パフォーマンス改善の提案、(4) 潜在的なバグの発見、(5) SOW形式での改善計画策定。言語・フレームワーク非依存で動作。
---

# コード品質レビュー

## 概要

実装完了後やPR作成前にコード品質を検証し、問題点と改善提案をレポートする。

## 検証観点

### 1. 静的解析チェック

プロジェクトの設定に応じて適切なコマンドを実行：

```bash
# 言語/フレームワーク検出後、該当するチェックを実行
# TypeScript: tsc --noEmit または pnpm/npm/yarn type-check
# Python: mypy, pyright
# Rust: cargo check
# Go: go vet
```

### 2. リントチェック

```bash
# プロジェクトのリンター設定を検出して実行
# JavaScript/TypeScript: eslint, biome
# Python: ruff, flake8, pylint
# Rust: cargo clippy
# Go: golangci-lint
```

### 3. コードレビュー観点

最近変更されたファイルを対象に以下を検証：

- **命名規則**: 一貫性のある命名、意図が明確な変数名
- **エラーハンドリング**: 適切な例外処理、エラー伝播
- **セキュリティ**: 入力検証、認証・認可、機密情報の扱い
- **パフォーマンス**: N+1問題、不要な再計算、メモリリーク
- **テスタビリティ**: 依存性注入、モック可能な設計
- **プロジェクト規約**: CLAUDE.md/AGENTS.mdに記載のパターン準拠

## レポート形式

```markdown
# コード品質レポート

## 概要

- チェック対象: [対象ファイル/パッケージ]
- 実行日時: [日時]
- 総合判定: ✅ 合格 / ⚠️ 要修正 / ❌ 重大な問題あり

## 静的解析

| 状態    | 詳細                           |
| ------- | ------------------------------ |
| [✅/❌] | [エラー内容または「問題なし」] |

## リントチェック

| 状態       | 詳細                                |
| ---------- | ----------------------------------- |
| [✅/⚠️/❌] | [警告/エラー内容または「問題なし」] |

## コードレビュー指摘事項

### 重大度: 高

- [指摘内容と該当箇所 (ファイル:行番号)]

### 重大度: 中

- [指摘内容と該当箇所]

### 重大度: 低（推奨事項）

- [指摘内容と該当箇所]

## 推奨アクション

1. [具体的な修正アクション]
```

## 言語別リファレンス

言語固有の詳細なチェック項目は以下を参照：

- **TypeScript/JavaScript**: [references/typescript.md](references/typescript.md)
- **Python**: [references/python.md](references/python.md)
- **その他の言語**: 同様のパターンで追加可能

## 実行フロー

1. `git diff` で変更ファイルを特定
2. プロジェクトの言語・ツールチェーンを検出
3. 該当する静的解析・リントを実行
4. コードレビュー観点で変更箇所を検証
5. レポートを生成

## 自己検証チェックリスト

- [ ] 全チェックコマンドを実行した
- [ ] エラーメッセージを正確に記録した
- [ ] 指摘に具体的なファイルパス・行番号を含めた
- [ ] 推奨アクションは実行可能で具体的
- [ ] レポートは日本語で記述
